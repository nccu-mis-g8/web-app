{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\gp-web-app\\\\src\\\\components\\\\chat\\\\ContactPerson.js\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { redirect } from \"react-router-dom\";\nimport def_avatar from \"../../images/default_avatar.png\";\nimport classes from \"./ContactPerson.module.css\";\nimport { deleteModel } from \"../../utils/modelUtils\";\nimport { refresh } from \"../../utils/tokenUtils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ContactPerson({\n  name,\n  modelId,\n  personality,\n  photo,\n  isSelected,\n  onClick\n}) {\n  _s();\n  const [showModal, setShowModal] = useState(false);\n  const handleRightClick = event => {\n    event.preventDefault(); // 阻止預設右鍵選單\n    setShowModal(true);\n  };\n  const handleCloseModal = () => {\n    setShowModal(false);\n  };\n  async function handleConfirmDelete() {\n    try {\n      const response = await deleteModel(modelId);\n      const accessToken = localStorage.getItem(\"accessToken\");\n      if (response.status === 200) {\n        setShowModal(false);\n        console.log(\"刪除模型成功\");\n        window.location.reload();\n      } else if (response.status === 400) {\n        const responseData = await response.json();\n        const error = responseData.error;\n        console.log(\"錯誤訊息: \" + error);\n      } else if (response.status === 401 && accessToken) {\n        // access Token過期，用refresh Token去拿新的access Token\n        const checkReTokenStatus = await refresh();\n        if (checkReTokenStatus) {\n          const response = await deleteModel(modelId);\n          if (response.status === 200) {\n            setShowModal(false);\n            console.log(\"刪除模型成功\");\n            window.location.reload();\n          }\n        } else {\n          // refresh Token過期，重新登入並刪掉 localStorage 裡的東西\n          // alert(\"refresh Token過期，請重新登入!\");\n          localStorage.clear();\n          return redirect(\"/login\");\n        }\n      } else {\n        const responseData = await response.json();\n        const error = responseData.message;\n        console.error(error);\n        alert(\"發生錯誤，請重新整理後再試一次\");\n      }\n    } catch (error) {\n      console.error(\"Error durning delete model: \", error);\n      redirect(\"/login\");\n    }\n  }\n  ;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${classes.container} ${isSelected ? classes.isSelected : \"\"} ${!showModal ? classes.disableInteraction : \"\"}`,\n    onClick: onClick,\n    onContextMenu: handleRightClick,\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: photo,\n      alt: \"\\u6A21\\u578B\\u982D\\u50CF\",\n      className: classes.avatar\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.content,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.name,\n        children: [\"\\u59D3\\u540D\\uFF1A \", name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.personality,\n        children: [\"\\u500B\\u6027\\u7559\\u8A00\\uFF1A \", personality]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this), showModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.modalBackdrop,\n      onClick: handleCloseModal,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.modal,\n        onClick: event => event.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u662F\\u5426\\u8981\\u522A\\u9664\\u6B64\\u6A21\\u578B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.modalButtons,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: classes.cancelButton,\n            onClick: handleCloseModal,\n            children: \"\\u5426\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: classes.confirmButton,\n            onClick: handleConfirmDelete,\n            children: \"\\u662F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 9\n  }, this);\n}\n_s(ContactPerson, \"uVlnG5KLfXemZk5i5Fl+Cg356FU=\");\n_c = ContactPerson;\nexport default ContactPerson;\nvar _c;\n$RefreshReg$(_c, \"ContactPerson\");","map":{"version":3,"names":["useState","redirect","def_avatar","classes","deleteModel","refresh","jsxDEV","_jsxDEV","ContactPerson","name","modelId","personality","photo","isSelected","onClick","_s","showModal","setShowModal","handleRightClick","event","preventDefault","handleCloseModal","handleConfirmDelete","response","accessToken","localStorage","getItem","status","console","log","window","location","reload","responseData","json","error","checkReTokenStatus","clear","message","alert","className","container","disableInteraction","onContextMenu","children","src","alt","avatar","fileName","_jsxFileName","lineNumber","columnNumber","content","modalBackdrop","modal","stopPropagation","modalButtons","cancelButton","confirmButton","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/gp-web-app/src/components/chat/ContactPerson.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { redirect } from \"react-router-dom\";\r\nimport def_avatar from \"../../images/default_avatar.png\";\r\nimport classes from \"./ContactPerson.module.css\";\r\nimport { deleteModel } from \"../../utils/modelUtils\";\r\nimport { refresh } from \"../../utils/tokenUtils\";\r\n\r\nfunction ContactPerson({ name, modelId, personality, photo, isSelected, onClick }) {\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    const handleRightClick = (event) => {\r\n        event.preventDefault(); // 阻止預設右鍵選單\r\n        setShowModal(true);\r\n    };\r\n\r\n    const handleCloseModal = () => {\r\n        setShowModal(false);\r\n    };\r\n\r\n    async function handleConfirmDelete() {\r\n\r\n        try {\r\n            const response = await deleteModel(modelId);\r\n            const accessToken = localStorage.getItem(\"accessToken\");\r\n\r\n            if (response.status === 200) {\r\n                setShowModal(false);\r\n                console.log(\"刪除模型成功\");\r\n                window.location.reload();\r\n            } else if (response.status === 400) {\r\n                const responseData = await response.json();\r\n                const error = responseData.error;\r\n                console.log(\"錯誤訊息: \" + error);\r\n            } else if (response.status === 401 && accessToken) {\r\n                // access Token過期，用refresh Token去拿新的access Token\r\n                const checkReTokenStatus = await refresh();\r\n        \r\n                if (checkReTokenStatus) {\r\n                    const response = await deleteModel(modelId);\r\n        \r\n                    if (response.status === 200) {\r\n                        setShowModal(false);\r\n                        console.log(\"刪除模型成功\");\r\n                        window.location.reload();\r\n                    }\r\n                } else {\r\n                    // refresh Token過期，重新登入並刪掉 localStorage 裡的東西\r\n                    // alert(\"refresh Token過期，請重新登入!\");\r\n                    localStorage.clear();\r\n                    return redirect(\"/login\");\r\n                }\r\n            } else {\r\n                const responseData = await response.json();\r\n                const error = responseData.message;\r\n                console.error(error);\r\n                alert(\"發生錯誤，請重新整理後再試一次\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error durning delete model: \", error);\r\n            redirect(\"/login\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className={`${classes.container} ${\r\n                isSelected ? classes.isSelected : \"\"\r\n            } ${!showModal ? classes.disableInteraction : \"\"}`}\r\n            onClick={onClick}\r\n            onContextMenu={handleRightClick}\r\n        >\r\n            <img src={photo} alt=\"模型頭像\" className={classes.avatar} />\r\n            <div className={classes.content}>\r\n                <div className={classes.name}>姓名： {name}</div>\r\n                <div className={classes.personality}>\r\n                    個性留言： {personality}\r\n                </div>\r\n            </div>\r\n            {showModal && (\r\n                <div className={classes.modalBackdrop} onClick={handleCloseModal}>\r\n                    <div className={classes.modal} onClick={(event) => event.stopPropagation()}>\r\n                        <p>是否要刪除此模型</p>\r\n                        <div className={classes.modalButtons}>\r\n                            <button\r\n                                className={classes.cancelButton}\r\n                                onClick={handleCloseModal}\r\n                            >\r\n                                否\r\n                            </button>\r\n                            <button\r\n                                className={classes.confirmButton}\r\n                                onClick={handleConfirmDelete}\r\n                            >\r\n                                是\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ContactPerson;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}